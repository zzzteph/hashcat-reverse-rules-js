"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function k(t){const e=new Map,a=t.match(/(\d+)$/);if(a){const c=a[1],n=c.length;for(let r=1;r<=n;r++){const o=t.slice(0,-r),l=c.slice(-r).split("").map(h=>`$${h}`).join(" ");e.set(o,l)}}return e}function g(t){const e=new Map,a=/[@#$%^&*()]$/,c=/(\d|[@#$%^&*()])$/;if(a.test(t)){const n=t.slice(-1),r=t.slice(0,-1);if(c.test(r)){const o=r.slice(-1),l=r.slice(0,-1);e.set(l,`$${o} $${n}`)}e.set(r,`$${n}`)}return e}function y(t){const e=new Map,a=/(19[7-9][0-9]|20[0-2][0-6])([@#$%^&*()!])$/;if(a.test(t)){const c=t.match(a),n=c[1],r=c[2],o=t.slice(0,-n.length-1),l=n.split("").map(h=>`$${h}`).join("");e.set(o,`${l}$${r}`)}else{const c=/(19[7-9][0-9]|20[0-2][0-6])$/;if(c.test(t)){const n=t.match(c)[0],r=t.slice(0,-n.length),o=n.split("").map(l=>`$${l}`).join("");e.set(r,o)}}return e}function S(t){const e=new Map,a=/([@#$%^&*()!]{1,4})$/;if(a.test(t)){const c=t.match(a)[0],n=c.length;for(let r=1;r<=n;r++){const o=t.slice(0,-r),l=c.slice(-r).split("").map(h=>`$${h}`).join(" ");e.set(o,l)}}return e}function w(t){const e=new Map,a=["12345","1234","123","12345!","1234!","123!","!12345","!1234","!123","123!@#","1234!@#"];for(const c of a)if(t.endsWith(c)){const n=t.slice(0,-c.length),r=c.split("").map(o=>`$${o}`).join("");e.set(n,r);break}return e}function M(t){const e=new Map;if(t.length==0)return e;if(t[0]===t[0].toUpperCase()&&t[0]!==t[0].toLowerCase()){const a=t[0].toLowerCase()+t.slice(1);e.set(a,"c")}return e}function L(t){const e=new Map,a=/^(200[0-9]|201[0-9]|202[0-6])/,c=/^\d+/,n=["!@#","!@","!"];for(const r of n)if(t.startsWith(r)){const o=t.slice(r.length),l=r.split("").reverse().map(h=>`^${h}`).join("");return e.set(o,l),e}if(a.test(t)){const r=t.match(a)[0],o=t.slice(r.length),l=r.split("").reverse().map(h=>`^${h}`).join("");return e.set(o,l),e}if(c.test(t)){const r=t.match(c)[0],o=t.slice(r.length),l=r.split("").reverse().map(h=>`^${h}`).join("");return e.set(o,l),e}return e}function j(t){const e=new Map,a=/^(.+)\1$/;if(a.test(t)){const c=t.match(a)[1];e.set(c,"d")}return e}function v(t){const e=new Map;if(t.length%2===0){const a=t.length/2,c=t.slice(0,a),n=t.slice(a).split("").reverse().join("");c===n&&e.set(c,"f")}return e}function u(t,e){return e.forEach((a,c)=>{c.length!=0&&t.set(c,a.replace(/\s+/g,""))}),t}function $(t,e,a){return e.forEach((c,n)=>{n.length!=0&&t.set(n,(c+a).replace(/\s+/g,""))}),t}function R(t){let e=new Map;return u(e,k(t)),u(e,g(t)),u(e,y(t)),u(e,S(t)),u(e,w(t)),u(e,L(t)),u(e,M(t)),u(e,j(t)),u(e,v(t)),e}function z(t,e=!1){let a=new Map;u(a,k(t)),u(a,g(t)),u(a,y(t)),u(a,S(t)),u(a,w(t)),u(a,L(t)),u(a,M(t)),u(a,j(t)),u(a,v(t));let c=new Map;for(const[r,o]of a.entries())$(c,R(r),o);if(u(a,c),e)return a;let n=[];for(const[r,o]of a.entries())n.push(r);return n}function f(t){return typeof t=="number"?t:t>="0"&&t<="9"?Number(t):Number(t.toUpperCase().charCodeAt(0)-55)}function x(t){return[t]}function b(t,e=10){t=t.toLowerCase();let a=new Set;a.add(t.toUpperCase()),a.add(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()),a.add(t.charAt(0).toLowerCase()+t.slice(1).toUpperCase());let c=new Set;for(let l=0;l<t.length;l++){let h=t.split("");for(let s=0;s<=l;s++)h[s]=h[s].toUpperCase();c.add(h.join(""))}let n=[...c],r=Math.min(e,n.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*n.length);o.add(n[l])}for(let l of o)a.add(l);return[...a]}function C(t,e=10){t=t.toUpperCase();let a=new Set;a.add(t.toLowerCase()),a.add(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()),a.add(t.charAt(0).toLowerCase()+t.slice(1).toUpperCase());let c=new Set;for(let l=0;l<t.length;l++){let h=t.split("");for(let s=0;s<=l;s++)h[s]=h[s].toLowerCase();c.add(h.join(""))}let n=[...c],r=Math.min(e,n.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*n.length);o.add(n[l])}for(let l of o)a.add(l);return[...a]}function U(t,e=10){t=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();let a=new Set;a.add(t.toLowerCase()),a.add(t.toUpperCase()),a.add(t.charAt(0).toLowerCase()+t.slice(1).toUpperCase());let c=new Set;for(let l of C(t))c.add(l);for(let l of b(t))c.add(l);let n=[...c],r=Math.min(e,n.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*n.length);o.add(n[l])}for(let l of o)a.add(l);return[...a]}function N(t,e=10){t=t.charAt(0).toLowerCase()+t.slice(1).toUpperCase();let a=new Set;a.add(t.toLowerCase()),a.add(t.toUpperCase()),a.add(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());let c=new Set;for(let l of C(t))c.add(l);for(let l of b(t))c.add(l);let n=[...c],r=Math.min(e,n.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*n.length);o.add(n[l])}for(let l of o)a.add(l);return[...a]}function P(t){let e="";for(let a of t)a===a.toLowerCase()?e+=a.toUpperCase():e+=a.toLowerCase();return[e]}function I(t,e){if(e=f(e),t.charAt(e)===t.charAt(e).toUpperCase())return[t.slice(0,e)+t.charAt(e).toLowerCase()+t.slice(e+1)];if(t.charAt(e)===t.charAt(e).toLowerCase())return[t.slice(0,e)+t.charAt(e).toUpperCase()+t.slice(e+1)]}function D(t){return[t.split("").reverse().join("")]}function T(t){const e=t.length;if(e%2!==0)return[];const a=t.slice(0,e/2);return a.repeat(2)===t?[a]:[]}function q(t,e){if(e=f(e),e<=0)return[];const a=e+1,c=t.length;if(c%a!==0)return[];const n=c/a,r=t.slice(0,n);return r.repeat(a)===t?[r]:[]}function E(t){const e=t.length;if(e%2!==0)return[];const a=t.slice(0,e/2);return a+a.split("").reverse().join("")===t?[a]:[]}function _(t){return[t.charAt(t.length-1)+t.slice(0,t.length-1)]}function W(t){return[t.slice(1)+t.charAt(0)]}function Y(t,e){return t.endsWith(e)?[t.slice(0,-e.length)]:[]}function O(t,e){return t.startsWith(e)?[t.slice(e.length)]:[]}function F(t){let e="!@#$qazwsxedcrfvtgbyhnujmikopl";e=e+e.toUpperCase()+"1234567890";for(let c of e);return[e[Math.floor(Math.random()*e.length)]+t]}function B(t){let e="!@#$qazwsxedcrfvtgbyhnujmikopl";e=e+e.toUpperCase()+"1234567890";for(let c of e);return[t+e[Math.floor(Math.random()*e.length)]]}function K(t,e){e=f(e);let a="!@#$qazwsxedcrfvtgbyhnujmikopl";return a=a+a.toUpperCase()+"1234567890",e>t.length?[]:[t.slice(0,e)+a[Math.floor(Math.random()*a.length)]+t.slice(e)]}function Z(t,e,a,c=10){if(e=f(e),a=f(a),!Number.isInteger(e)||e<0||e>t.length)return[];if(!Number.isInteger(a)||a<=0)return[];if(e>a)return[];let n=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],r=Array.from({length:151},(m,p)=>String(1900+p)),o=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],l=[...o,...o.map(m=>m.charAt(0).toUpperCase()+m.slice(1))],h=Array.from({length:999},(m,p)=>String(p+1)),s=[...n,...r,...l,...h],i=[];for(let m of s)m.length==a-e&&i.push(m);let d=new Set;for(let m=0;m<c;m++)d.add(t.slice(0,e)+i[Math.floor(Math.random()*i.length)])+t.slice(e);return[...d]}function H(t,e,a,c=10){if(e=f(e),a=f(a),!Number.isInteger(e)||e<0||e>t.length)return[];if(!Number.isInteger(a)||a<=0)return[];if(e>a)return[];if(a<=t.length-1)return[];let n=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],r=Array.from({length:151},(d,m)=>String(1900+m)),o=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],l=[...o,...o.map(d=>d.charAt(0).toUpperCase()+d.slice(1))],h=Array.from({length:999},(d,m)=>String(m+1)),s=[...n,...r,...l,...h],i=new Set;for(let d=0;d<c;d++)i.add(t+s[Math.floor(Math.random()*s.length)]),i.add(s[Math.floor(Math.random()*s.length)]+t+s[Math.floor(Math.random()*s.length)]),i.add(s[Math.floor(Math.random()*s.length)]+t);return[...i]}function G(t,e,a){return e=f(e),e<0||e>=t.length?[]:t[e]===a?[t.slice(0,e)+t.slice(e+1)]:[]}function J(t,e,a,c=10){if(e=f(e),e<0||e>=t.length)return[];let n="qazwsxedcrfvtgbyhnujmikopl";if(n=n+n.toUpperCase()+"1234567890",t[e].toLowerCase()===a.toLowerCase()){let o=[];for(let l=0;l<c;l++)o.push(t.slice(0,e)+n[Math.floor(Math.random()*n.length)]+t.slice(e+1));return o}return[]}function Q(t,e,a=10){if(e=f(e),!Number.isInteger(e)||e<0)return[];if(e!=t.length)return[];let c=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],n=Array.from({length:151},(i,d)=>String(1900+d)),r=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],o=[...r,...r.map(i=>i.charAt(0).toUpperCase()+i.slice(1))],l=Array.from({length:999},(i,d)=>String(d+1)),h=[...c,...n,...o,...l],s=new Set;for(let i=0;i<a;i++)s.add(t+h[Math.floor(Math.random()*h.length)]);return[...s]}function V(t,e,a){return[t.replaceAll(a,e)]}function X(t,e){if(t.includes(e))return[];const a=Math.floor(Math.random()*(t.length+1));return t.slice(0,a)+e+t.slice(a)}function ee(t,e){if(e=f(e),!t)return[];const a=t[0];let c=1;for(;c<t.length&&t[c]===a;)c++;let n=Math.min(e,c-1);return[t.slice(0,1)+t.slice(1+n)]}function te(t,e){if(e=f(e),!t)return[];let a=t[t.length-1],c=t.length-2;for(;c>=0&&t[c]===a;)c--;const n=Math.min(e,t.length-1-c-1);return[t.slice(0,t.length-n)]}function ae(t){if(!t)return[];let e="",a=0;for(;a<t.length;)e+=t[a],a+1<t.length&&t[a+1]===t[a]?a+=2:a+=1;return[e]}function re(t){return t.length<2?[]:[t[1]+t[0]+t.slice(2)]}function ce(t){return t.length<2?[]:[t.slice(0,-2)+t[t.length-1]+t[t.length-2]]}function ne(t,e,a){if(e=f(e),a=f(a),e<0||a<0||e>=t.length||a>=t.length)return[];if(e===a)return[];let c=t.split("");return[c[e],c[a]]=[c[a],c[e]],[c.join("")]}function oe(t,e){if(e=f(e),e<0||e>=t.length)return[];let a=t.split(""),c=a[e].charCodeAt(0);return a[e]=String.fromCharCode(c>>1),[a.join("")]}function le(t,e){if(e=f(e),e<0||e>=t.length)return[];let a=t.split(""),c=a[e].charCodeAt(0);return a[e]=String.fromCharCode(c<<1),[a.join("")]}function he(t,e){if(e=f(e),e<0||e>=t.length)return[];let a=t.split("");return a[e]=String.fromCharCode(a[e].charCodeAt(0)-1),[a.join("")]}function se(t,e){if(e=f(e),e<0||e>=t.length)return[];let a=t.split("");return a[e]=String.fromCharCode(a[e].charCodeAt(0)+1),[a.join("")]}function fe(t,e){if(e=f(e),e<0||e>=t.length-1)return[];let a=t.split("");return a[e]=a[e-1],[a.join("")]}function ue(t,e){if(e=f(e),e<0||e>=t.length)return[];let a=t.split("");return a[e]=a[e+1],[a.join("")]}function ie(t,e){if(e=f(e),e<=0||e*2>t.length)return[];let a=t.slice(-e),c=t.slice(-2*e,-e);return a===c?[t.slice(0,-e)]:[]}function de(t,e){if(e=f(e),e<=0||e*2>t.length)return[];let a=t.slice(0,e),c=t.slice(e,e*2);return a===c?[a+t.slice(e*2)]:[]}function me(t,e){t=t.toLowerCase();let a="",c=!0;for(let n=0;n<t.length;n++){let r=t[n];c&&/[a-z]/i.test(r)?(a+=r.toLowerCase(),c=!1):a+=r,r===e&&(c=!0)}return[a]}function pe(t){return t=t.toLowerCase(),[t.split(" ").map(e=>e.charAt(0).toLowerCase()+e.slice(1)).join(" ")]}function be(t,e,a){for(var c=0;c<e.length;)switch(e.charAt(c)){case":":return x(t);case"l":return b(t,a);case"u":return C(t,a);case"c":return U(t,a);case"C":return N(t,a);case"t":return P(t);case"T":return I(t,e.charAt(c+1));case"r":return D(t);case"d":return T(t);case"p":return q(t,e.charAt(c+1));case"f":return E(t);case"{":return _(t);case"}":return W(t);case"$":return Y(t,e.charAt(c+1));case"^":return O(t,e.charAt(c+1));case"[":return F(t);case"]":return B(t);case"D":return K(t,e.charAt(c+1));case"x":return H(t,e.charAt(c+1),e.charAt(c+2),a);case"O":return Z(t,e.charAt(c+1),e.charAt(c+2),a);case"i":return G(t,e.charAt(c+1),e.charAt(c+2));case"o":return J(t,e.charAt(c+1),e.charAt(c+2),a);case"'":return Q(t,e.charAt(c+1));case"s":return V(t,e.charAt(c+1),e.charAt(c+2));case"@":return X(t,e.charAt(c+1));case"z":return ee(t,e.charAt(c+1));case"Z":return te(t,e.charAt(c+1));case"q":return ae(t);case"k":return re(t);case"K":return ce(t);case"*":return ne(t,e.charAt(c+1),e.charAt(c+2));case"L":return oe(t,e.charAt(c+1));case"R":return le(t,e.charAt(c+1));case"+":return he(t,e.charAt(c+1));case"-":return se(t,e.charAt(c+1));case".":return fe(t,e.charAt(c+1));case",":return ue(t,e.charAt(c+1));case"y":return de(t,e.charAt(c+1));case"Y":return ie(t,e.charAt(c+1));case"e":return me(t,e.charAt(c+1));case"E":return pe(t)}}function A(t,e,a){let c=[],n=t.length;for(let o=0;o<n;o++)c=c.concat(be(t[o],e,a));let r=new Set;n=c.length;for(let o=0;o<c.length;o++)r.add(c[o]);return Array.from(r)}function Ce(t,e,a=65e3,c=10){let n=[];if(e.trim().charAt(0)==="#")return[t];if(e.trim().length===0)return[t];for(var r=0;r<e.length;)switch(e.charAt(r)){case":":n.push(":"),r++;break;case"l":n.push("l"),r++;break;case"u":n.push("u"),r++;break;case"c":n.push("c"),r++;break;case"C":n.push("C"),r++;break;case"t":n.push("t"),r++;break;case"T":if(r+1>=e.length)break;n.push("T".concat(e.charAt(r+1))),r+=2;break;case"r":n.push("r"),r++;break;case"d":n.push("d"),r++;break;case"p":if(r+1>=e.length)break;n.push("p".concat(e.charAt(r+1))),r+=2;break;case"f":n.push("f"),r++;break;case"{":n.push("{"),r++;break;case"}":n.push("}"),r++;break;case"$":if(r+1>=e.length)break;n.push("$".concat(e.charAt(r+1))),r+=2;break;case"^":if(r+1>=e.length)break;n.push("^".concat(e.charAt(r+1))),r+=2;break;case"[":n.push("["),r++;break;case"]":n.push("]"),r++;break;case"D":if(r+1>=e.length)break;n.push("D".concat(e.charAt(r+1))),r+=2;break;case"x":if(r+2>=e.length)break;n.push("x".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"O":if(r+2>=e.length)break;n.push("O".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"i":if(r+2>=e.length)break;n.push("i".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"o":if(r+2>=e.length)break;n.push("o".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"'":if(r+1>=e.length)break;n.push("'".concat(e.charAt(r+1))),r+=2;break;case"s":if(r+2>=e.length)break;n.push("s".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"@":if(r+1>=e.length)break;n.push("@".concat(e.charAt(r+1))),r+=2;break;case"z":if(r+1>=e.length)break;n.push("z".concat(e.charAt(r+1))),r+=2;break;case"Z":if(r+1>=e.length)break;n.push("Z".concat(e.charAt(r+1))),r+=2;break;case"q":n.push("q"),r++;break;case"k":n.push("k"),r++;break;case"K":n.push("K"),r++;break;case"*":if(r+2>=e.length)break;n.push("*".concat(e.charAt(r+1)).concat(e.charAt(r+2))),r+=3;break;case"L":if(r+1>=e.length)break;n.push("L".concat(e.charAt(r+1))),r+=2;break;case"R":if(r+1>=e.length)break;n.push("R".concat(e.charAt(r+1))),r+=2;break;case"+":if(r+1>=e.length)break;n.push("+".concat(e.charAt(r+1))),r+=2;break;case"-":if(r+1>=e.length)break;n.push("-".concat(e.charAt(r+1))),r+=2;break;case".":if(r+1>=e.length)break;n.push(".".concat(e.charAt(r+1))),r+=2;break;case",":if(r+1>=e.length)break;n.push(",".concat(e.charAt(r+1))),r+=2;break;case"y":if(r+1>=e.length)break;n.push("y".concat(e.charAt(r+1))),r+=2;break;case"Y":if(r+1>=e.length)break;n.push("Y".concat(e.charAt(r+1))),r+=2;break;case"e":if(r+1>=e.length)break;n.push("e".concat(e.charAt(r+1))),r+=2;break;case"E":n.push("E"),r++;break;default:r++;break}if(n.length==0)return[t];n=n.reverse();let o=[];for(var r=0;r<n.length&&(r==0?o=A([t],n[r],c):o=A(o,n[r],c),!(a!==!1&&o.length>a));r++);return o}exports.applyReverseRule=Ce;exports.generateCandidates=z;
