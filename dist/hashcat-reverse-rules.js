"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function $(e){const t=new Map,a=e.match(/(\d+)$/);if(a){const c=a[1],r=c.length;for(let n=1;n<=r;n++){const s=e.slice(0,-n),o=c.slice(-n).split("").map(h=>`$${h}`).join(" ");t.set(s,o)}}return t}function k(e){const t=new Map,a=/[@#$%^&*()]$/,c=/(\d|[@#$%^&*()])$/;if(a.test(e)){const r=e.slice(-1),n=e.slice(0,-1);if(c.test(n)){const s=n.slice(-1),o=n.slice(0,-1);t.set(o,`$${s} $${r}`)}t.set(n,`$${r}`)}return t}function v(e){const t=new Map,a=/(19[7-9][0-9]|20[0-2][0-6])([@#$%^&*()!])$/;if(a.test(e)){const c=e.match(a),r=c[1],n=c[2],s=e.slice(0,-r.length-1),o=r.split("").map(h=>`$${h}`).join("");t.set(s,`${o}$${n}`)}else{const c=/(19[7-9][0-9]|20[0-2][0-6])$/;if(c.test(e)){const r=e.match(c)[0],n=e.slice(0,-r.length),s=r.split("").map(o=>`$${o}`).join("");t.set(n,s)}}return t}function y(e){const t=new Map,a=/([@#$%^&*()!]{1,4})$/;if(a.test(e)){const c=e.match(a)[0],r=c.length;for(let n=1;n<=r;n++){const s=e.slice(0,-n),o=c.slice(-n).split("").map(h=>`$${h}`).join(" ");t.set(s,o)}}return t}function R(e){const t=new Map,a=["12345","1234","123","12345!","1234!","123!","!12345","!1234","!123","123!@#","1234!@#"];for(const c of a)if(e.endsWith(c)){const r=e.slice(0,-c.length),n=c.split("").map(s=>`$${s}`).join("");t.set(r,n);break}return t}function L(e){const t=new Map;if(e.length==0)return t;if(e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()){const a=e[0].toLowerCase()+e.slice(1);t.set(a,"c")}return t}function j(e){const t=new Map,a=/^(200[0-9]|201[0-9]|202[0-6])/,c=/^\d+/,r=["!@#","!@","!"];for(const n of r)if(e.startsWith(n)){const s=e.slice(n.length),o=n.split("").reverse().map(h=>`^${h}`).join("");return t.set(s,o),t}if(a.test(e)){const n=e.match(a)[0],s=e.slice(n.length),o=n.split("").reverse().map(h=>`^${h}`).join("");return t.set(s,o),t}if(c.test(e)){const n=e.match(c)[0],s=e.slice(n.length),o=n.split("").reverse().map(h=>`^${h}`).join("");return t.set(s,o),t}return t}function w(e){const t=new Map,a=/^(.+)\1$/;if(a.test(e)){const c=e.match(a)[1];t.set(c,"d")}return t}function x(e){const t=new Map;if(e.length%2===0){const a=e.length/2,c=e.slice(0,a),r=e.slice(a).split("").reverse().join("");c===r&&t.set(c,"f")}return t}function l(e,t){return t.forEach((a,c)=>{c.length!=0&&e.set(c,a.replace(/\s+/g,""))}),e}function S(e,t,a){return t.forEach((c,r)=>{r.length!=0&&e.set(r,(c+a).replace(/\s+/g,""))}),e}function N(e){let t=new Map;return l(t,$(e)),l(t,k(e)),l(t,v(e)),l(t,y(e)),l(t,R(e)),l(t,j(e)),l(t,L(e)),l(t,w(e)),l(t,x(e)),t}function T(e,t=!1){let a=new Map;l(a,$(e)),l(a,k(e)),l(a,v(e)),l(a,y(e)),l(a,R(e)),l(a,j(e)),l(a,L(e)),l(a,w(e)),l(a,x(e));let c=new Map;for(const[n,s]of a.entries())S(c,N(n),s);if(l(a,c),t)return a;let r=[];for(const[n,s]of a.entries())r.push(n);return r}function f(e){return typeof e=="number"?e:e>="0"&&e<="9"?Number(e):Number(e.toUpperCase().charCodeAt(0)-55)}function P(e){return[e]}function A(e){e=e.toLowerCase();let t=[];t.push(e.toUpperCase()),t.push(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),t.push(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase());for(let a=0;a<e.length;a++){let c=e.split("");for(let r=0;r<=a;r++)c[r]=c[r].toUpperCase();t.push(c.join(""))}return t}function C(e){e=e.toUpperCase();let t=[];t.push(e.toLowerCase()),t.push(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),t.push(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase());for(let a=0;a<e.length;a++){let c=e.split("");for(let r=0;r<=a;r++)c[r]=c[r].toLowerCase();t.push(c.join(""))}return t}function D(e){e=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();let t=[];return t.push(e.toLowerCase()),t.push(e.toUpperCase()),t.push(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase()),t=t.concat(C(e)),t=t.concat(A(e)),t}function g(e){e=e.charAt(0).toLowerCase()+e.slice(1).toUpperCase();let t=[];return t.push(e.toLowerCase()),t.push(e.toUpperCase()),t.push(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),t=t.concat(C(e)),t=t.concat(A(e)),t}function q(e){for(var t=[],a=0;a<e.length;a++)t=M(e,a);return t}function M(e,t){if(t=f(t),e.charAt(t)===e.charAt(t).toUpperCase())return[e.slice(0,t)+e.charAt(t).toLowerCase()+e.slice(t+1)];if(e.charAt(t)===e.charAt(t).toLowerCase())return[e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1)]}function z(e){return[e.split("").reverse().join("")]}function W(e){const t=e.length;if(t%2!==0)return[];const a=e.slice(0,t/2);return a.repeat(2)===e?[a]:[]}function _(e,t){if(t=f(t),t<=0)return[];let a=e.length;if(a%t!==0)return[];let c=e.slice(0,a/t);return c.repeat(t)===e?[c]:[]}function E(e){const t=e.length;if(t%2!==0)return[];const a=e.slice(0,t/2);return a+a.split("").reverse().join("")===e?[a]:[]}function O(e){return[e.charAt(e.length-1)+e.slice(0,e.length-1)]}function I(e){return[e.slice(1)+e.charAt(0)]}function Y(e,t){return e.endsWith(t)?[e.slice(0,-t.length)]:[]}function Z(e,t){return e.startsWith(t)?[e.slice(t.length)]:[]}function F(e){let t="!@#$";return t=t+"1234567890",[t[Math.floor(Math.random()*t.length)]+e]}function H(e){let t="!@#$";return t=t+"1234567890",[e+t[Math.floor(Math.random()*t.length)]]}function G(e,t){t=f(t);let a="qazwsxedcrfvtgbyhnujmikopl";return a=a+a.toUpperCase()+"1234567890",t>e.length?[e]:[e.slice(0,t)+a[Math.floor(Math.random()*a.length)]+e.slice(t)]}function U(e,t,a){if(t=f(t),a=f(a),!Number.isInteger(t)||t<0||t>e.length)return[];if(!Number.isInteger(a)||a<=0)return[];let c=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],r=Array.from({length:151},(u,d)=>String(1900+d)),n=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],s=[...n,...n.map(u=>u.charAt(0).toUpperCase()+u.slice(1))],o=Array.from({length:999},(u,d)=>String(d+1)),h=[...c,...r,...s,...o],p=[];for(let u=0;u<h.length;u++)h[u].length===a&&(p.includes(h[u])||p.push(h[u]));let i=e.slice(0,t),m=e.slice(t);return p.map(u=>i+u+m)}function B(e,t,a){return U(e,t,a)}function J(e,t,a){return t=f(t),t<0||t>=e.length?[e]:e[t]===a?[e.slice(0,t)+e.slice(t+1)]:[]}function K(e,t,a){if(t=f(t),t<0||t>=e.length)return[e];let c="qazwsxedcrfvtgbyhnujmikopl";if(c=c+c.toUpperCase()+"1234567890",e[t].toLowerCase()===a.toLowerCase()){let n=[];for(let s of c)n.push(e.slice(0,t)+s+e.slice(t+1));return n}return[]}function Q(e,t){if(t=f(t),!Number.isInteger(t)||t<0)return[];let a=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],c=Array.from({length:151},(i,m)=>String(1900+m)),r=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],n=[...r,...r.map(i=>i.charAt(0).toUpperCase()+i.slice(1))],s=Array.from({length:999},(i,m)=>String(m+1)),o=[...a,...c,...n,...s],h=e.slice(0,t),p=e.slice(t);return o.map(i=>h+i+p)}function V(e,t,a){return[e.replaceAll(a,t)]}function X(e,t){if(e.includes(t))return[e];const a=Math.floor(Math.random()*(e.length+1));return e.slice(0,a)+t+e.slice(a)}function ee(e,t){if(t=f(t),!e)return[e];const a=e[0];let c=1;for(;c<e.length&&e[c]===a;)c++;let r=Math.min(t,c-1);return[e.slice(0,1)+e.slice(1+r)]}function te(e,t){if(t=f(t),!e)return e;let a=e[e.length-1],c=e.length-2;for(;c>=0&&e[c]===a;)c--;const r=Math.min(t,e.length-1-c-1);return[e.slice(0,e.length-r)]}function ae(e){if(!e)return[e];let t="",a=0;for(;a<e.length;)t+=e[a],a+1<e.length&&e[a+1]===e[a]?a+=2:a+=1;return[t]}function re(e,t){for(var a=0;a<t.length;)switch(t.charAt(a)){case":":return P(e);case"l":return A(e);case"u":return C(e);case"c":return D(e);case"C":return g(e);case"t":return q(e);case"T":return M(e,t.charAt(a+1));case"r":return z(e);case"d":return W(e);case"p":return _(e,t.charAt(a+1));case"f":return E(e);case"{":return O(e);case"}":return I(e);case"$":return Y(e,t.charAt(a+1));case"^":return Z(e,t.charAt(a+1));case"[":return F(e);case"]":return H(e);case"D":return G(e,t.charAt(a+1));case"x":return U(e,t.charAt(a+1),t.charAt(a+2));case"O":return B(e,t.charAt(a+1),t.charAt(a+2));case"i":return J(e,t.charAt(a+1),t.charAt(a+2));case"o":return K(e,t.charAt(a+1),t.charAt(a+2));case"'":return Q(e,t.charAt(a+1));case"s":return V(e,t.charAt(a+1),t.charAt(a+2));case"@":return X(e,t.charAt(a+1));case"z":return ee(e,t.charAt(a+1));case"Z":return te(e,t.charAt(a+1));case"q":return ae(e)}}function b(e,t){let a=[],c=e.length;for(let n=0;n<c;n++)a=a.concat(re(e[n],t));let r=new Set;c=a.length;for(let n=0;n<a.length;n++)r.add(a[n]);return Array.from(r)}function ce(e,t,a=65e3){let c=[];if(t.trim().charAt(0)==="#")return[e];if(t.trim().length===0)return[e];for(var r=0;r<t.length;)switch(t.charAt(r)){case":":c.push(":"),r++;break;case"l":c.push("l"),r++;break;case"u":c.push("u"),r++;break;case"c":c.push("c"),r++;break;case"C":c.push("C"),r++;break;case"t":c.push("t"),r++;break;case"T":c.push("T".concat(t.charAt(r+1))),r+=2;break;case"r":c.push("r"),r++;break;case"d":c.push("d"),r++;break;case"p":c.push("p".concat(t.charAt(r+1))),r+=2;break;case"f":c.push("f"),r++;break;case"{":c.push("{"),r++;break;case"}":c.push("}"),r++;break;case"$":c.push("$".concat(t.charAt(r+1))),r+=2;break;case"^":c.push("^".concat(t.charAt(r+1))),r+=2;break;case"[":c.push("["),r++;break;case"]":c.push("]"),r++;break;case"D":c.push("D".concat(t.charAt(r+1))),r+=2;break;case"x":c.push("x".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"O":c.push("O".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"i":c.push("i".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"o":c.push("o".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"'":c.push("'".concat(t.charAt(r+1))),r+=2;break;case"s":c.push("s".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"@":c.push("@".concat(t.charAt(r+1))),r+=2;break;case"z":c.push("z".concat(t.charAt(r+1))),r+=2;break;case"Z":c.push("Z".concat(t.charAt(r+1))),r+=2;break;case"q":c.push("q"),r++;break;default:r++;break}if(c.length==0)return[e];c=c.reverse();let n=[];for(var r=0;r<c.length&&(r==0?n=b([e],c[r]):n=b(n,c[r]),!(a!==!1&&n.length>a));r++);return n}exports.generateCandidates=T;exports.reverseTheRule=ce;
