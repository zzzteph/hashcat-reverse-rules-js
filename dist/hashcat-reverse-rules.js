"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function w(e){const t=new Map,a=e.match(/(\d+)$/);if(a){const n=a[1],c=n.length;for(let r=1;r<=c;r++){const o=e.slice(0,-r),l=n.slice(-r).split("").map(s=>`$${s}`).join(" ");t.set(o,l)}}return t}function M(e){const t=new Map,a=/[@#$%^&*()]$/,n=/(\d|[@#$%^&*()])$/;if(a.test(e)){const c=e.slice(-1),r=e.slice(0,-1);if(n.test(r)){const o=r.slice(-1),l=r.slice(0,-1);t.set(l,`$${o} $${c}`)}t.set(r,`$${c}`)}return t}function y(e){const t=new Map,a=/(19[7-9][0-9]|20[0-2][0-6])([@#$%^&*()!])$/;if(a.test(e)){const n=e.match(a),c=n[1],r=n[2],o=e.slice(0,-c.length-1),l=c.split("").map(s=>`$${s}`).join("");t.set(o,`${l}$${r}`)}else{const n=/(19[7-9][0-9]|20[0-2][0-6])$/;if(n.test(e)){const c=e.match(n)[0],r=e.slice(0,-c.length),o=c.split("").map(l=>`$${l}`).join("");t.set(r,o)}}return t}function k(e){const t=new Map,a=/([@#$%^&*()!]{1,4})$/;if(a.test(e)){const n=e.match(a)[0],c=n.length;for(let r=1;r<=c;r++){const o=e.slice(0,-r),l=n.slice(-r).split("").map(s=>`$${s}`).join(" ");t.set(o,l)}}return t}function v(e){const t=new Map,a=["12345","1234","123","12345!","1234!","123!","!12345","!1234","!123","123!@#","1234!@#"];for(const n of a)if(e.endsWith(n)){const c=e.slice(0,-n.length),r=n.split("").map(o=>`$${o}`).join("");t.set(c,r);break}return t}function S(e){const t=new Map;if(e.length==0)return t;if(e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()){const a=e[0].toLowerCase()+e.slice(1);t.set(a,"c")}return t}function $(e){const t=new Map,a=/^(200[0-9]|201[0-9]|202[0-6])/,n=/^\d+/,c=["!@#","!@","!"];for(const r of c)if(e.startsWith(r)){const o=e.slice(r.length),l=r.split("").reverse().map(s=>`^${s}`).join("");return t.set(o,l),t}if(a.test(e)){const r=e.match(a)[0],o=e.slice(r.length),l=r.split("").reverse().map(s=>`^${s}`).join("");return t.set(o,l),t}if(n.test(e)){const r=e.match(n)[0],o=e.slice(r.length),l=r.split("").reverse().map(s=>`^${s}`).join("");return t.set(o,l),t}return t}function g(e){const t=new Map,a=/^(.+)\1$/;if(a.test(e)){const n=e.match(a)[1];t.set(n,"d")}return t}function j(e){const t=new Map;if(e.length%2===0){const a=e.length/2,n=e.slice(0,a),c=e.slice(a).split("").reverse().join("");n===c&&t.set(n,"f")}return t}function f(e,t){return t.forEach((a,n)=>{n.length!=0&&e.set(n,a.replace(/\s+/g,""))}),e}function R(e,t,a){return t.forEach((n,c)=>{c.length!=0&&e.set(c,(n+a).replace(/\s+/g,""))}),e}function L(e){let t=new Map;return f(t,w(e)),f(t,M(e)),f(t,y(e)),f(t,k(e)),f(t,v(e)),f(t,$(e)),f(t,S(e)),f(t,g(e)),f(t,j(e)),t}function z(e,t=!1){let a=new Map;f(a,w(e)),f(a,M(e)),f(a,y(e)),f(a,k(e)),f(a,v(e)),f(a,$(e)),f(a,S(e)),f(a,g(e)),f(a,j(e));let n=new Map;for(const[r,o]of a.entries())R(n,L(r),o);if(f(a,n),t)return a;let c=[];for(const[r,o]of a.entries())c.push(r);return c}function m(e){return typeof e=="number"?e:e>="0"&&e<="9"?Number(e):Number(e.toUpperCase().charCodeAt(0)-55)}function x(e){return[e]}function C(e,t=10){e=e.toLowerCase();let a=new Set;a.add(e.toUpperCase()),a.add(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),a.add(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase());let n=new Set;for(let l=0;l<e.length;l++){let s=e.split("");for(let h=0;h<=l;h++)s[h]=s[h].toUpperCase();n.add(s.join(""))}let c=[...n],r=Math.min(t,c.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*c.length);o.add(c[l])}for(let l of o)a.add(l);return[...a]}function A(e,t=10){e=e.toUpperCase();let a=new Set;a.add(e.toLowerCase()),a.add(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),a.add(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase());let n=new Set;for(let l=0;l<e.length;l++){let s=e.split("");for(let h=0;h<=l;h++)s[h]=s[h].toLowerCase();n.add(s.join(""))}let c=[...n],r=Math.min(t,c.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*c.length);o.add(c[l])}for(let l of o)a.add(l);return[...a]}function U(e,t=10){e=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();let a=new Set;a.add(e.toLowerCase()),a.add(e.toUpperCase()),a.add(e.charAt(0).toLowerCase()+e.slice(1).toUpperCase());let n=new Set;for(let l of A(e))n.add(l);for(let l of C(e))n.add(l);let c=[...n],r=Math.min(t,c.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*c.length);o.add(c[l])}for(let l of o)a.add(l);return[...a]}function N(e,t=10){e=e.charAt(0).toLowerCase()+e.slice(1).toUpperCase();let a=new Set;a.add(e.toLowerCase()),a.add(e.toUpperCase()),a.add(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());let n=new Set;for(let l of A(e))n.add(l);for(let l of C(e))n.add(l);let c=[...n],r=Math.min(t,c.length),o=new Set;for(;o.size<r;){let l=Math.floor(Math.random()*c.length);o.add(c[l])}for(let l of o)a.add(l);return[...a]}function P(e){let t="";for(let a of e)a===a.toLowerCase()?t+=a.toUpperCase():t+=a.toLowerCase();return[t]}function T(e,t){if(t=m(t),e.charAt(t)===e.charAt(t).toUpperCase())return[e.slice(0,t)+e.charAt(t).toLowerCase()+e.slice(t+1)];if(e.charAt(t)===e.charAt(t).toLowerCase())return[e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1)]}function q(e){return[e.split("").reverse().join("")]}function D(e){const t=e.length;if(t%2!==0)return[];const a=e.slice(0,t/2);return a.repeat(2)===e?[a]:[]}function I(e,t){if(t=m(t),t<=0)return[];const a=t+1,n=e.length;if(n%a!==0)return[];const c=n/a,r=e.slice(0,c);return r.repeat(a)===e?[r]:[]}function _(e){const t=e.length;if(t%2!==0)return[];const a=e.slice(0,t/2);return a+a.split("").reverse().join("")===e?[a]:[]}function W(e){return[e.charAt(e.length-1)+e.slice(0,e.length-1)]}function E(e){return[e.slice(1)+e.charAt(0)]}function O(e,t){return e.endsWith(t)?[e.slice(0,-t.length)]:[]}function Y(e,t){return e.startsWith(t)?[e.slice(t.length)]:[]}function Z(e){let t="!@#$qazwsxedcrfvtgbyhnujmikopl";t=t+t.toUpperCase()+"1234567890";for(let n of t);return[t[Math.floor(Math.random()*t.length)]+e]}function F(e){let t="!@#$qazwsxedcrfvtgbyhnujmikopl";t=t+t.toUpperCase()+"1234567890";for(let n of t);return[e+t[Math.floor(Math.random()*t.length)]]}function H(e,t){t=m(t);let a="!@#$qazwsxedcrfvtgbyhnujmikopl";return a=a+a.toUpperCase()+"1234567890",t>e.length?[e]:[e.slice(0,t)+a[Math.floor(Math.random()*a.length)]+e.slice(t)]}function G(e,t,a,n=10){if(t=m(t),a=m(a),!Number.isInteger(t)||t<0||t>e.length)return[];if(!Number.isInteger(a)||a<=0)return[];if(t>a)return[];let c=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],r=Array.from({length:151},(i,p)=>String(1900+p)),o=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],l=[...o,...o.map(i=>i.charAt(0).toUpperCase()+i.slice(1))],s=Array.from({length:999},(i,p)=>String(p+1)),h=[...c,...r,...l,...s],u=[];for(let i of h)i.length==a-t&&u.push(i);let d=new Set;for(let i=0;i<n;i++)d.add(e.slice(0,t)+u[Math.floor(Math.random()*u.length)])+e.slice(t);return[...d]}function B(e,t,a,n=10){if(t=m(t),a=m(a),!Number.isInteger(t)||t<0||t>e.length)return[];if(!Number.isInteger(a)||a<=0)return[];if(t>a)return[];if(a<=e.length-1)return[];let c=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],r=Array.from({length:151},(d,i)=>String(1900+i)),o=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],l=[...o,...o.map(d=>d.charAt(0).toUpperCase()+d.slice(1))],s=Array.from({length:999},(d,i)=>String(i+1)),h=[...c,...r,...l,...s],u=new Set;for(let d=0;d<n;d++)u.add(e+h[Math.floor(Math.random()*h.length)]),u.add(h[Math.floor(Math.random()*h.length)]+e+h[Math.floor(Math.random()*h.length)]),u.add(h[Math.floor(Math.random()*h.length)]+e);return[...u]}function J(e,t,a){return t=m(t),t<0||t>=e.length?[e]:e[t]===a?[e.slice(0,t)+e.slice(t+1)]:[]}function K(e,t,a,n=10){if(t=m(t),t<0||t>=e.length)return[e];let c="qazwsxedcrfvtgbyhnujmikopl";if(c=c+c.toUpperCase()+"1234567890",e[t].toLowerCase()===a.toLowerCase()){let o=[];for(let l=0;l<n;l++)o.push(e.slice(0,t)+c[Math.floor(Math.random()*c.length)]+e.slice(t+1));return o}return[]}function Q(e,t,a=10){if(t=m(t),!Number.isInteger(t)||t<0)return[];if(t!=e.length)return[];let n=["123456","password","qwerty","111111","12345678","abc123","password1","123456789","1234567890","12345","000000","iloveyou","admin","welcome","monkey","dragon"],c=Array.from({length:151},(u,d)=>String(1900+d)),r=["john","michael","david","daniel","james","robert","mary","jennifer","linda","patricia","susan","jessica","maria","anna","andrew","thomas","alex","kate","olga","dmitry"],o=[...r,...r.map(u=>u.charAt(0).toUpperCase()+u.slice(1))],l=Array.from({length:999},(u,d)=>String(d+1)),s=[...n,...c,...o,...l],h=new Set;for(let u=0;u<a;u++)h.add(e+s[Math.floor(Math.random()*s.length)]);return[...h]}function V(e,t,a){return[e.replaceAll(a,t)]}function X(e,t){if(e.includes(t))return[e];const a=Math.floor(Math.random()*(e.length+1));return e.slice(0,a)+t+e.slice(a)}function ee(e,t){if(t=m(t),!e)return[e];const a=e[0];let n=1;for(;n<e.length&&e[n]===a;)n++;let c=Math.min(t,n-1);return[e.slice(0,1)+e.slice(1+c)]}function te(e,t){if(t=m(t),!e)return e;let a=e[e.length-1],n=e.length-2;for(;n>=0&&e[n]===a;)n--;const c=Math.min(t,e.length-1-n-1);return[e.slice(0,e.length-c)]}function ae(e){if(!e)return[e];let t="",a=0;for(;a<e.length;)t+=e[a],a+1<e.length&&e[a+1]===e[a]?a+=2:a+=1;return[t]}function re(e,t,a){for(var n=0;n<t.length;)switch(t.charAt(n)){case":":return x(e);case"l":return C(e,a);case"u":return A(e,a);case"c":return U(e,a);case"C":return N(e,a);case"t":return P(e);case"T":return T(e,t.charAt(n+1));case"r":return q(e);case"d":return D(e);case"p":return I(e,t.charAt(n+1));case"f":return _(e);case"{":return W(e);case"}":return E(e);case"$":return O(e,t.charAt(n+1));case"^":return Y(e,t.charAt(n+1));case"[":return Z(e);case"]":return F(e);case"D":return H(e,t.charAt(n+1));case"x":return B(e,t.charAt(n+1),t.charAt(n+2),a);case"O":return G(e,t.charAt(n+1),t.charAt(n+2),a);case"i":return J(e,t.charAt(n+1),t.charAt(n+2));case"o":return K(e,t.charAt(n+1),t.charAt(n+2),a);case"'":return Q(e,t.charAt(n+1));case"s":return V(e,t.charAt(n+1),t.charAt(n+2));case"@":return X(e,t.charAt(n+1));case"z":return ee(e,t.charAt(n+1));case"Z":return te(e,t.charAt(n+1));case"q":return ae(e)}}function b(e,t,a){let n=[],c=e.length;for(let o=0;o<c;o++)n=n.concat(re(e[o],t,a));let r=new Set;c=n.length;for(let o=0;o<n.length;o++)r.add(n[o]);return Array.from(r)}function ne(e,t,a=65e3,n=10){let c=[];if(t.trim().charAt(0)==="#")return[e];if(t.trim().length===0)return[e];for(var r=0;r<t.length;)switch(t.charAt(r)){case":":c.push(":"),r++;break;case"l":c.push("l"),r++;break;case"u":c.push("u"),r++;break;case"c":c.push("c"),r++;break;case"C":c.push("C"),r++;break;case"t":c.push("t"),r++;break;case"T":c.push("T".concat(t.charAt(r+1))),r+=2;break;case"r":c.push("r"),r++;break;case"d":c.push("d"),r++;break;case"p":c.push("p".concat(t.charAt(r+1))),r+=2;break;case"f":c.push("f"),r++;break;case"{":c.push("{"),r++;break;case"}":c.push("}"),r++;break;case"$":c.push("$".concat(t.charAt(r+1))),r+=2;break;case"^":c.push("^".concat(t.charAt(r+1))),r+=2;break;case"[":c.push("["),r++;break;case"]":c.push("]"),r++;break;case"D":c.push("D".concat(t.charAt(r+1))),r+=2;break;case"x":c.push("x".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"O":c.push("O".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"i":c.push("i".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"o":c.push("o".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"'":c.push("'".concat(t.charAt(r+1))),r+=2;break;case"s":c.push("s".concat(t.charAt(r+1)).concat(t.charAt(r+2))),r+=3;break;case"@":c.push("@".concat(t.charAt(r+1))),r+=2;break;case"z":c.push("z".concat(t.charAt(r+1))),r+=2;break;case"Z":c.push("Z".concat(t.charAt(r+1))),r+=2;break;case"q":c.push("q"),r++;break;default:r++;break}if(c.length==0)return[e];c=c.reverse();let o=[];for(var r=0;r<c.length&&(r==0?o=b([e],c[r],n):o=b(o,c[r],n),!(a!==!1&&o.length>a));r++);return o}exports.applyReverseRule=ne;exports.generateCandidates=z;
